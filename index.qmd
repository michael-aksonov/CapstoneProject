---
title: "Capstone Project"
author: "Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk"
format:
  revealjs:
    navigation-mode: linear
    controls: true
    controls-layout: edges
    controls-tutorial: true
    controls-back-arrows: faded
    logo: logo_primary_color.png
    center: false
editor: visual
---

------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Methodology

------------------------------------------------------------------------
:::

::: {style="font-size:35px"}
We start with estimating a Cobb-Douglas cost function with following specification: \begin{gather*}
c=A( \prod_i w_i^{a_i} )y^{a_y}
\end{gather*} Applying logarithm to linarize we achieve: \begin{gather*}
ln(c)=\alpha_0+\sum_i \alpha_i w_i + \alpha_y ln(y)
\end{gather*} where $c$ is total cost, $w_i$ are input costs, $y$ is output and $A$ is some technology factor
:::

::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::

------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Methodology

------------------------------------------------------------------------
:::

::: {style="font-size:35px"}
Marginal costs are then derived as: \begin{gather*}
\frac{\partial c(w,y)}{\partial y}= \alpha_y \frac{c(w,y)}{y}
\end{gather*} and average costs are just: \begin{gather*}
\frac{c(w,y)}{y}
\end{gather*}
:::

::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::

------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Data
:::

::: {style="font-size:35px"}
For the purpose of this task we have used UZ quartely financial statistics from 2015 to 2020. Grouping different costs (like electricity bills and fuel costs in "utilities") results in the following summary statistic:

::: columns
::: column
```{r}
#| warning: false
#| echo: false

library(plm)
library(car)
library(stargazer)
library(readxl)
library(ggplot2)
library(dplyr)
library(ggthemes)
library(extrafont)
library(remotes)

railway_data <- read_excel("railway_data.xlsx")

stargazer(as.data.frame(railway_data[c("Q", "l", "u", "c")]),type = "text", summary.stat = c("sd","mean", "n"), digits = 0)

```
:::

::: column
\

Whehe $Q$ is quantity in tkm, $l$ are costs of labor, $u$ are costs of utilities and $c$ is cost of capital in UAH
:::
:::
:::

::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::

------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Data
:::

::: {style="font-size:35px"}
Quarterly time series data
:::

::: {style="font-size:11px"}
::: panel-tabset
### Donetsk

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="DONETSK_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=l, color = "Labor"))+
  geom_line(mapping = aes(y=u, color = "Utility"))+
  geom_line(mapping = aes(y=c, color = "Capital"))+
  labs(
    title = "Quaterly costs",
    subtitle = "(2015-2020)",
    caption = "Source: SSU",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  


```

### Pridnidrovska

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="PRIDNIPROVSKA_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=l, color = "Labor"))+
  geom_line(mapping = aes(y=u, color = "Utility"))+
  geom_line(mapping = aes(y=c, color = "Capital"))+
  labs(
    title = "Quaterly costs",
    subtitle = "(2015-2020)",
    caption = "Source: SSU",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  

```

### Lviv

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="LVIV_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=l, color = "Labor"))+
  geom_line(mapping = aes(y=u, color = "Utility"))+
  geom_line(mapping = aes(y=c, color = "Capital"))+
  labs(
    title = "Quaterly costs",
    subtitle = "(2015-2020)",
    caption = "Source: SSU",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  

```

### Odessa

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="ODESSA_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=l, color = "Labor"))+
  geom_line(mapping = aes(y=u, color = "Utility"))+
  geom_line(mapping = aes(y=c, color = "Capital"))+
  labs(
    title = "Quaterly costs",
    subtitle = "(2015-2020)",
    caption = "Source: SSU",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  

```

### South-Western

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="SOUTH-WESTERN RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=l, color = "Labor"))+
  geom_line(mapping = aes(y=u, color = "Utility"))+
  geom_line(mapping = aes(y=c, color = "Capital"))+
  labs(
    title = "Quaterly costs",
    subtitle = "(2015-2020)",
    caption = "Source: SSU",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  

```

### Southern

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="SOUTHERN_RAILWAYS",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=l, color = "Labor"))+
  geom_line(mapping = aes(y=u, color = "Utility"))+
  geom_line(mapping = aes(y=c, color = "Capital"))+
  labs(
    title = "Quaterly costs",
    subtitle = "(2015-2020)",
    caption = "Source: SSU",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  

```
:::
:::

::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::

------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Data
:::

::: {style="font-size:35px"}
However, we have to account for inflation.

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="SOUTHERN_RAILWAYS",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=cpi),color = rgb(68/255,114/255,169/255))+
  labs(
    title = "Quaterly CPI",
    subtitle = "(2015-2020)",
    caption = "Source: IMF",
    x = "Number of Quarters since 2015Q1",
    y = "CPI, QoQ"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")
  

```
:::


::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::

------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Data
:::

::: {style="font-size:35px"}
All financial data is then adjusted for inflation.
:::

::: {style="font-size:11px"}
::: panel-tabset
### Donetsk

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="DONETSK_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=lc, color = "Labor"))+
  geom_line(mapping = aes(y=uc, color = "Utility"))+
  geom_line(mapping = aes(y=cc, color = "Capital"))+
  labs(
    title = "Quaterly costs - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  


```

### Pridnidrovska

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="PRIDNIPROVSKA_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=lc, color = "Labor"))+
  geom_line(mapping = aes(y=uc, color = "Utility"))+
  geom_line(mapping = aes(y=cc, color = "Capital"))+
  labs(
    title = "Quaterly costs - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  

```

### Lviv

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="LVIV_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=lc, color = "Labor"))+
  geom_line(mapping = aes(y=uc, color = "Utility"))+
  geom_line(mapping = aes(y=cc, color = "Capital"))+
  labs(
    title = "Quaterly costs - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  

```

### Odessa

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="ODESSA_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=lc, color = "Labor"))+
  geom_line(mapping = aes(y=uc, color = "Utility"))+
  geom_line(mapping = aes(y=cc, color = "Capital"))+
  labs(
    title = "Quaterly costs - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  

```

### South-Western

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="SOUTH-WESTERN RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=lc, color = "Labor"))+
  geom_line(mapping = aes(y=uc, color = "Utility"))+
  geom_line(mapping = aes(y=cc, color = "Capital"))+
  labs(
    title = "Quaterly costs - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  

```

### Southern

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="SOUTHERN_RAILWAYS",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=lc, color = "Labor"))+
  geom_line(mapping = aes(y=uc, color = "Utility"))+
  geom_line(mapping = aes(y=cc, color = "Capital"))+
  labs(
    title = "Quaterly costs - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Costs',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(42000000,1240000000), breaks = seq(42000000,1240000000,42000000*4))
  

```
:::
:::

::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::

------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Data
:::

::: {style="font-size:35px"}
After quarterly prices of inputs are calculated.
:::

::: {style="font-size:11px"}
::: panel-tabset
### Donetsk

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="DONETSK_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=plc, color = "Labor"))+
  geom_line(mapping = aes(y=puc, color = "Utility"))+
  geom_line(mapping = aes(y=pcc, color = "Capital"))+
  labs(
    title = "Quaterly input prices - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Price, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Prices',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(0.015,0.6), breaks = seq(0.015,0.6,0.015*6))
  


```

### Pridnidrovska

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="PRIDNIPROVSKA_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=plc, color = "Labor"))+
  geom_line(mapping = aes(y=puc, color = "Utility"))+
  geom_line(mapping = aes(y=pcc, color = "Capital"))+
  labs(
    title = "Quaterly input prices - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Price, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Prices',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(0.015,0.6), breaks = seq(0.015,0.6,0.015*6))

```

### Lviv

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="LVIV_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=plc, color = "Labor"))+
  geom_line(mapping = aes(y=puc, color = "Utility"))+
  geom_line(mapping = aes(y=pcc, color = "Capital"))+
  labs(
    title = "Quaterly input prices - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Price, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Prices',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(0.015,0.6), breaks = seq(0.015,0.6,0.015*6))
  

```

### Odessa

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="ODESSA_RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=plc, color = "Labor"))+
  geom_line(mapping = aes(y=puc, color = "Utility"))+
  geom_line(mapping = aes(y=pcc, color = "Capital"))+
  labs(
    title = "Quaterly input prices - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Price, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Prices',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(0.015,0.6), breaks = seq(0.015,0.6,0.015*6))
```

### South-Western

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="SOUTH-WESTERN RAILWAY",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=plc, color = "Labor"))+
  geom_line(mapping = aes(y=puc, color = "Utility"))+
  geom_line(mapping = aes(y=pcc, color = "Capital"))+
  labs(
    title = "Quaterly input prices - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Price, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Prices',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(0.015,0.6), breaks = seq(0.015,0.6,0.015*6))

```

### Southern

```{r}
#| warning: false
#| echo: false

ggplot(railway_data[railway_data$railway_name=="SOUTHERN_RAILWAYS",],mapping=aes(x=quarters))+
  geom_line(mapping = aes(y=plc, color = "Labor"))+
  geom_line(mapping = aes(y=puc, color = "Utility"))+
  geom_line(mapping = aes(y=pcc, color = "Capital"))+
  labs(
    title = "Quaterly input prices - Inflation Adjusted",
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Price, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='Prices',
                     breaks=c("Labor","Utility","Capital"),
                     values=c("Labor"=rgb(68/255,114/255,169/255), "Utility"=rgb(237/255,125/255,49/255),"Capital"= rgb(144/255,238/255,144/255)))+
  scale_y_continuous(limits = c(0.015,0.6), breaks = seq(0.015,0.6,0.015*6))
```
:::
:::

::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::

------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Results
:::

::: {style="font-size:35px"}
Now we estimate Coubb-Duglas cost function coefficients using panel data linear regression

::: columns
::: {.column width="70%"}
```{r}

#| warning: false
#| echo: false

model <- plm(log(tc) ~ log(plc) + log(puc)
             + log(pcc) + log(Q) + network_length,
             data = railway_data, index = c("railway_name","quarters"))

stargazer(model, type = "text",
          covariate.labels = c("ln(Price of Labor)", "ln(Price of Utilities)", "ln(Price of Capital)","ln(Output)"),
          dep.var.labels   = "ln(Total Cost)",
          single.row = TRUE)

```
:::

::: {.column width="30%"}
As we can see, all coefficients sum to 1, but this has to be checked
:::

:::

:::

::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::


------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Results
:::

::: {style="font-size:35px"}
Test linear hypothesis:
```{r}

#| warning: false
#| echo: false
linearHypothesis(model, "log(plc) + log(puc) + log(pcc) + log(Q) = 1" )

```

We fail to reject the null, so our coefficients are OK. 
:::



::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::

------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Results
:::

::: {style="font-size:35px"}
At last we calculate yearly average costs and compare them with actual $TR/Q$ to make tariff recommendation

```{r}
#| warning: false
#| echo: false
earnings_data <- read_excel("earnings_data.xlsx", 
    sheet = "earnings_data")
```

::: {style="font-size:11px"}
::: panel-tabset
### Donetsk
```{r}
#| warning: false
#| echo: false
#| out-height: 400px
#| out-width: 700px

ggplot(earnings_data[earnings_data$railway_name=="DONETSK_RAILWAY",],mapping = aes(x=year))+
  geom_line(mapping = aes(y=TRQ, color="TR/Q"))+
  geom_line(mapping = aes(y=estimated, color = "Estimation"))+
  labs(
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='A',
                     breaks=c("TR/Q","Estimation"),
                     values=c("TR/Q"=rgb(68/255,114/255,169/255),"Estimation"=rgb(237/255,125/255,49/255)))+
  scale_y_continuous(limits = c(0.1,0.5), breaks = seq(0.1,0.5,0.1))
  

```

### Pridnidrovska
```{r}
#| warning: false
#| echo: false

ggplot(earnings_data[earnings_data$railway_name=="PRIDNIPROVSKA_RAILWAY",],mapping = aes(x=year))+
  geom_line(mapping = aes(y=TRQ, color="TR/Q"))+
  geom_line(mapping = aes(y=estimated, color = "Estimation"))+
  labs(
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='',
                     breaks=c("TR/Q","Estimation"),
                     values=c("TR/Q"=rgb(68/255,114/255,169/255), "Estimation"=rgb(237/255,125/255,49/255)))+
  scale_y_continuous(limits = c(0.1,0.5), breaks = seq(0.1,0.5,0.1))
  

```
### Lviv
```{r}
#| warning: false
#| echo: false

ggplot(earnings_data[earnings_data$railway_name=="LVIV_RAILWAY",],mapping = aes(x=year))+
  geom_line(mapping = aes(y=TRQ, color="TR/Q"))+
  geom_line(mapping = aes(y=estimated, color = "Estimation"))+
  labs(
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='',
                     breaks=c("TR/Q","Estimation"),
                     values=c("TR/Q"=rgb(68/255,114/255,169/255), "Estimation"=rgb(237/255,125/255,49/255)))+
  scale_y_continuous(limits = c(0.1,0.5), breaks = seq(0.1,0.5,0.1))
  

```
### Odessa
```{r}
#| warning: false
#| echo: false

ggplot(earnings_data[earnings_data$railway_name=="ODESSA_RAILWAY",],mapping = aes(x=year))+
  geom_line(mapping = aes(y=TRQ, color="TR/Q"))+
  geom_line(mapping = aes(y=estimated, color = "Estimation"))+
  labs(
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='',
                     breaks=c("TR/Q","Estimation"),
                     values=c("TR/Q"=rgb(68/255,114/255,169/255), "Estimation"=rgb(237/255,125/255,49/255)))+
  scale_y_continuous(limits = c(0.1,0.5), breaks = seq(0.1,0.5,0.1))
  

```
### South-Western
```{r}
#| warning: false
#| echo: false

ggplot(earnings_data[earnings_data$railway_name=="SOUTH-WESTERN RAILWAY",],mapping = aes(x=year))+
  geom_line(mapping = aes(y=TRQ, color="TR/Q"))+
  geom_line(mapping = aes(y=estimated, color = "Estimation"))+
  labs(
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='',
                     breaks=c("TR/Q","Estimation"),
                     values=c("TR/Q"=rgb(68/255,114/255,169/255), "Estimation"=rgb(237/255,125/255,49/255)))+
  scale_y_continuous(limits = c(0.1,0.5), breaks = seq(0.1,0.5,0.1))
  

```
### Southern
```{r}
#| warning: false
#| echo: false

ggplot(earnings_data[earnings_data$railway_name=="SOUTHERN_RAILWAYS",],mapping = aes(x=year))+
  geom_line(mapping = aes(y=TRQ, color="TR/Q"))+
  geom_line(mapping = aes(y=estimated, color = "Estimation"))+
  labs(
    subtitle = "(2015-2020)",
    caption = "Source: Derivation",
    x = "Number of Quarters since 2015Q1",
    y = "Cost, UAH"
  )+
  theme_bw(base_size = 14, base_family = "Segoe UI Light")+
  scale_color_manual(name='',
                     breaks=c("TR/Q","Estimation"),
                     values=c("TR/Q"=rgb(68/255,114/255,169/255), "Estimation"=rgb(237/255,125/255,49/255)))+
  scale_y_continuous(limits = c(0.1,0.5), breaks = seq(0.1,0.5,0.1))
  

```
:::
:::

:::



::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::


------------------------------------------------------------------------

::: {style="font-size:45px; color: grey"}
Results
:::

::: {style="font-size:35px"}
Judging by estimation results, our recommendations are:

::: {.fragment}
Southern Railway freight tariff has to be increased

Lviv Railway freight tariff has to be increased
:::

\

::: {.fragment}
Donetsk Railway freight tariff is optimal

Pridniprovska Railway freight tariff is optimal

Odessa Railway freight tariff is optimal

South-Western Railway freight tariff is optimal
:::

:::

::: {.footer style="height:55px;background-color:lightgray;z-index:-1;bottom:0%"}
::: footer
Mykhailo Aksonov - Yevhenia Mitriakhina - Daniil Minakov - Iryna Pavliuk
:::
:::

